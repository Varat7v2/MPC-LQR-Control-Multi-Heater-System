%% SBMHS LQOC CAD data plottings
clear all; clc; close all

% Load excel file data
lqoc_data = xlsread('SBMHS_LQOC_CAD_data.xlsx');
[row, col] = size(lqoc_data);

Uk_c = [lqoc_data(:,4) lqoc_data(:,6)];
Rk = [lqoc_data(:,8) lqoc_data(:,11)];
Yk = [lqoc_data(:,9) lqoc_data(:,12)];

% Distrubances
D1 = [lqoc_data(:,3)]; % Fan as disturbance
D2 = [lqoc_data(:,5)]; % Heater2 as disturbance
D3 = [lqoc_data(:,7)]; % Heater4 as disturbance

ek = [lqoc_data(98:end,15) lqoc_data(98:end,16)];

% % Display simulations results gradually
figure, subplot(211), stairs(Uk_c(:,1))
xlabel('Sampling Instant'), ylabel('U1(k)')
title('Controller Inputs U1(k) Vs Sampling Time')
subplot(212), stairs(Uk_c(:,2)')
xlabel('Sampling Instant'), ylabel('U2(k)')
title('Controller Inputs U2(k) Vs Sampling Time')


figure, plot(Rk(:,1), '-r'), hold on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
plot(Yk(:,1), '-b'), hold off
xlabel('Sampling Instant'), ylabel('R1(k) & Y1(k)')
legend('Setpoint R1(k)', 'Measurement Y1(k)')
title('Setpoint R1(k) Vs. Measurment Y1(k)')

figure, plot(Rk(:,2), '-r'), hold on
plot(Yk(:,2), '-b'), hold off
xlabel('Sampling Instant'), ylabel('R2(k) & Y2(k)')
legend('Setpoint R2(k)', 'Measurement Y2(k)')
title('Setpoint R2(k) Vs. Measurment Y2(k)')

figure, subplot(211), plot(ek(:,1))
xlabel('Sampling Instant'), ylabel('e1(k)')
title('e_1(k) Vs Sampling Time')
subplot(212), plot(ek(:,2))
xlabel('Sampling Instant'), ylabel('e2(k)')
title('e_2(k) Vs Sampling Time')

figure, 
yyaxis left, plot(D1), hold on
plot(Rk(:,1), '-r'),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
plot(Yk(:,1), '-b'),
xlabel('Sampling Instant')
ylabel('Fan Speed(%) and Temperature (deg. C)')
title('LQOC Control against various disturbances')
yyaxis right
plot(D2),plot(D3), hold off
xlabel('Sampling Instant')
ylabel('Heater Inputs (Volts Parts)'),
legend('Fan speed', 'Setpoint1', 'Yk1','Heater2', 'Heater4' )

figure, 
yyaxis left, plot(D1), hold on
plot(Rk(:,2), '-r'),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
plot(Yk(:,2), '-b'),
xlabel('Sampling Instant')
ylabel('Fan Speed(%) and Temperature (deg. C)')
title('LQOC Control against various disturbances')
yyaxis right
plot(D2),plot(D3), hold off
xlabel('Sampling Instant')
ylabel('Heater Inputs (Volts Parts)'),
legend('Fan speed', 'Setpoint2', 'Yk2','Heater2', 'Heater4' )
